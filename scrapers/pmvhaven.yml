name: PMVHaven

sceneByName:
  action: scrapeJson
  queryURL: https://pmvhaven.com/api/videos/search?limit=32&page=1&q={}
  scraper: sceneSearch

sceneByURL:
  - action: scrapeJson
    url:
      - pmvhaven.com/video/
    queryURL: https://pmvhaven.com/api/videos/{url}/watch-page
    queryURLReplace:
      url:
        - regex: .*([a-z0-9]{24}).*
          with: $1
    scraper: sceneScraper

sceneByQueryFragment:
  action: scrapeJson
  queryURL: https://pmvhaven.com/api/videos/search?limit=32&page=1&q={}
  scraper: sceneSearch

jsonScrapers:
  sceneSearch:
    common:
      $data: data.0
    scene:
      Title: $data.title

  sceneScraper:
    scene:
      Title: data.video.title
      Date:
        selector: data.video.uploadDate
        postProcess:
          - replace:
              - regex: "T(.*)$"
                with: ""
          - parseDate: 2006-01-02

      Details: data.video.description
      Tags:
        Name: data.video.tags
      Performers:
        Name: data.video.starsTags
      Image: data.video.thumbnailUrl
      Studio:
        Name: data.video.creator.0
      URL:
        selector: data.video._id
        postProcess:
          - replace:
              - regex: (.*)
                with: https://pmvhaven.com/video/$1
  movieScraper:
    movie:
      Name:
        selector: //strong[text()='ID:']/../span
        concat: "|"
        postProcess:
          - replace:
              - regex: \|
                with: ""
      Director: //strong[text()='Director:']/../span/a/text()
      Duration:
        selector: //strong[text()='Duration:']/../span/text()
        postProcess:
          - replace:
              - regex: \D
                with: ""
      Date: //strong[text()='Released Date:']/../span/text()
      Synopsis:
        selector: //h2[@class="title is-4"]/strong/text()
        postProcess:
          - replace:
              - regex: (.*?\s)(.+)
                with: $2
      Studio:
        Name:
          selector: //strong[text()='Maker:']/../span/a/text()|//strong[text()='Publisher:']/../span/a/text()
      FrontImage:
        selector: //img[@class="video-cover"]/@src
      URL: //link[@rel="canonical"]/@href
